---
import { contentfulClient } from "../contentful";
import type { EntryFieldTypes } from "contentful";

interface Person {
    contentTypeId: "person";
    fields: {
        name: EntryFieldTypes.Symbol;
        email: EntryFieldTypes.Symbol;
        phone: EntryFieldTypes.Symbol;
        role: EntryFieldTypes.Array<
            EntryFieldTypes.Symbol<
                "Secretaris" | "Vertrouwenscontactpersoon" | "Voorzitter"
            >
        >;
        photo: EntryFieldTypes.AssetLink;
    };
}

const contacts =
    await contentfulClient.withoutUnresolvableLinks.getEntries<Person>({
        content_type: "person",
    });

const voorzitter = contacts.items.find((contact) =>
    contact.fields.role.includes("Voorzitter"),
);
const secretary = contacts.items.find((contact) =>
    contact.fields.role.includes("Secretaris"),
);
const vertrouwenspersonen = contacts.items.filter((contact) =>
    contact.fields.role.includes("Vertrouwenscontactpersoon"),
);
---

<style>
    .contact-grid {
        display: flex;
        flex-wrap: nowrap; /* Ensures they stay next to each other */
        gap: 2rem;
        margin-top: 1.5rem;
    }

    .contact-card {
        display: flex;
        background: #fff;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        width: 50%;
        align-items: stretch;
        border-left: 8px solid #197052;
    }

    .contact-info {
        flex: 1;
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        justify-content: center;
        text-align: left;
    }

    .contact-info h3 {
        margin: 0;
        font-size: 1.4rem;
        font-weight: bold;
    }

    .contact-info p {
        margin: 0.2rem 0;
        color: #555;
    }

    .contact-image {
        flex: 1;
        width: 100%;
        height: auto;
        object-fit: cover;
        min-width: 130px;
    }

    .contact-card p strong {
        color: black;
    }
</style>

<section id="contact">
    <h1>Dit zijn onze <strong>contactpersonen</strong></h1>
    <p>
        Heb je vragen over de introductie, wil je meer weten over lidmaatschap
        of heb je andere vragen? Neem gerust contact met ons op! <br />
        We staan klaar om je te helpen, dus aarzel niet om een bericht te sturen!
    </p>

    <div class="contact-grid">
        {
            [voorzitter, secretary].map((contact) => (
                <div class="contact-card">
                    <div class="contact-info">
                        <h3>{contact!.fields.name}</h3>
                        <p>
                            <strong>{contact!.fields.role}</strong>
                        </p>
                        <p>ðŸ“§ {contact!.fields.email}</p>
                        <p>ðŸ“ž {contact!.fields.phone}</p>
                    </div>
                    <img
                        src={contact!.fields.photo?.fields.file?.url}
                        alt={contact!.fields.name}
                        class="contact-image"
                    />
                </div>
            ))
        }
    </div>
    <h1>Dit zijn onze <strong>vertrouwenscontactpersonen</strong></h1>
    <p>
        Bij Sticky vinden we een veilige en prettige omgeving voor al onze leden
        erg belangrijk. Mocht er iets voorvallen waar je mee zit, of heb je
        behoefte aan een vertrouwelijk gesprek, dan kun je terecht bij onze
        vertrouwenscontactpersonen. Zij luisteren naar je verhaal, bieden
        ondersteuning en kunnen je indien nodig doorverwijzen naar de juiste
        hulp.
    </p>
    <p>
        Alles wat je bespreekt blijft vertrouwelijk. Neem gerust contact op als
        je ergens over wilt praten.
    </p>
    <div class="contact-grid">
        {
            vertrouwenspersonen.map((contact) => (
                <div class="contact-card">
                    <div class="contact-info">
                        <h3>{contact!.fields.name}</h3>
                        <p>
                            <strong>{contact!.fields.role}</strong>
                        </p>
                        <p>ðŸ“ž {contact!.fields.phone}</p>
                    </div>
                    <img
                        src={contact!.fields.photo?.fields.file?.url}
                        alt={contact!.fields.name}
                        class="contact-image"
                    />
                </div>
            ))
        }
    </div>
</section>
